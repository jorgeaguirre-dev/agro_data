{
  "Comment": "Pipeline de datos agr√≠colas con Data Quality",
  "StartAt": "ProcesarRinde",
  "States": {
    "ProcesarRinde": {
      "Type": "Task",
      "Resource": "arn:aws:states:::glue:startJobRun.sync",
      "Parameters": {
        "JobName": "${GLUE_JOB_RINDE}",
        "Arguments": {
          "--input_path": "s3://${LANDING_BUCKET}/rinde_lotes.csv",
          "--output_path": "s3://${CURATED_BUCKET}/rinde_lotes"
        }
      },
      "Next": "ProcesarClima"
    },
    "ProcesarClima": {
      "Type": "Task",
      "Resource": "arn:aws:states:::glue:startJobRun.sync",
      "Parameters": {
        "JobName": "${GLUE_JOB_CLIMA}",
        "Arguments": {
          "--input_path": "s3://${LANDING_BUCKET}/clima_diario.csv",
          "--output_path": "s3://${CURATED_BUCKET}/clima_diario"
        }
      },
      "Next": "Crawlers"
    },
    "Crawlers": {
      "Type": "Parallel",
      "Branches": [
        {
          "StartAt": "CrawlerRinde",
          "States": {
            "CrawlerRinde": {
              "Type": "Task",
              "Resource": "arn:aws:states:::aws-sdk:glue:startCrawler",
              "Parameters": {
                "Name": "agro-rinde-crawler"
              },
              "End": true
            }
          }
        },
        {
          "StartAt": "CrawlerClima",
          "States": {
            "CrawlerClima": {
              "Type": "Task",
              "Resource": "arn:aws:states:::aws-sdk:glue:startCrawler",
              "Parameters": {
                "Name": "agro-clima-crawler"
              },
              "End": true
            }
          }
        }
      ],
      "Next": "DataQualityRinde"
    },
    "DataQualityRinde": {
      "Type": "Task",
      "Resource": "arn:aws:states:::glue:startJobRun.sync",
      "Parameters": {
        "JobName": "${GLUE_JOB_DQ}",
        "Arguments": {
          "--suite_name": "rinde_suite",
          "--database_name": "${DATABASE_NAME}",
          "--table_name": "rinde_lotes",
          "--results_bucket": "${CURATED_BUCKET}"
        }
      },
      "Next": "DataQualityClima"
    },
    "DataQualityClima": {
      "Type": "Task",
      "Resource": "arn:aws:states:::glue:startJobRun.sync",
      "Parameters": {
        "JobName": "${GLUE_JOB_DQ}",
        "Arguments": {
          "--suite_name": "clima_suite",
          "--database_name": "${DATABASE_NAME}",
          "--table_name": "clima_diario",
          "--results_bucket": "${CURATED_BUCKET}"
        }
      },
      "End": true
    }
  }
}